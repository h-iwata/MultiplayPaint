<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Exit Games Photon C++ Client Library: Workflow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Exit Games Photon C++ Client Library
   &#160;<span id="projectnumber">4.0.2.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00026.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Workflow </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>To get an impression of how to work on the client, we will use the server's Lite logic. This application defines rooms which are created when users try to join them. Each user in a room becomes an actor with its own number.</p>
<p>A simplified workflow looks like this:</p><ul>
<li>create a LitePeer instance</li>
<li>from now on: regularly call <a class="el" href="a00085.html#ac66e8bb0fdc525c5e250092c35343a2d">service()</a> to get events and operation responses and to send operations (e.g. ten times a second)</li>
<li>call <a class="el" href="a00085.html#ac455a0b79d0fb81a225bc1c57550bb5d">connect()</a> to connect to the server</li>
<li>wait until the library calls <a class="el" href="a00084.html#a762c08d3437006f3da1165e296bb52b3">onStatusChanged()</a></li>
<li>the return code should equal SC_CONNECT</li>
<li>call <a class="el" href="a00071.html#aa3c67ad2f68b154c4fe37ef12737b6f9">opJoin()</a> to get into a room</li>
<li>wait until the library calls <a class="el" href="a00084.html#a03ff8cb4a6f605668586756cb6a113c7">onOperationResponse()</a> with operation code OPC_RT_JOIN</li>
<li>send data in the game by calling <a class="el" href="a00071.html#a053c062465d25666c570dbb25fbbb218">opRaiseEvent()</a></li>
<li>receive events in <a class="el" href="a00084.html#aebac55de19a14f226016bee9dc2125b1">onEvent()</a></li>
<li>when you are done: call <a class="el" href="a00071.html#ab895dbaac2028a5551b02a8fcbcf662a">opLeave()</a> to quit/leave the game room</li>
<li>wait for a response to "leave" in <a class="el" href="a00084.html#a03ff8cb4a6f605668586756cb6a113c7">onOperationResponse()</a> with operation code: OPC_RT_LEAVE</li>
<li>disconnect with <a class="el" href="a00085.html#a888a5acf1fe3a8902f7cb2f5039cb334">disconnect()</a></li>
<li>wait for status code SC_DISCONNECT in <a class="el" href="a00084.html#a762c08d3437006f3da1165e296bb52b3">onStatusChanged()</a></li>
</ul>
<p>Combined with the server's Lite application, this simple workflow would allow you to use rooms and send your game's events. The functions used could be broken down into three layers:</p>
<ul>
<li>Low Level: <a class="el" href="a00085.html#ac66e8bb0fdc525c5e250092c35343a2d">service()</a>, <a class="el" href="a00085.html#ac455a0b79d0fb81a225bc1c57550bb5d">connect()</a>, <a class="el" href="a00085.html#a888a5acf1fe3a8902f7cb2f5039cb334">disconnect()</a> and <a class="el" href="a00084.html#a762c08d3437006f3da1165e296bb52b3">onStatusChanged()</a> are directly referring to the connection to the server. This level works with UDP/TCP packets which transport commands (which in turn carry your operations). It keeps your connection alive and organizes your RPC calls and events into packages.</li>
<li>Logic Level: operations, results and events make up the logical level in Photon. Any operation is defined on the server (think RPC call) and can have a result. Events are incoming from the server and update the client with some data.</li>
<li>Application Level: Made up by a specific application and its features. In this case we use the operations and logic of the Lite application. In this specific case, we have rooms and actors and more. The LitePeer is matching the server side implementation and wraps it up for you.</li>
</ul>
<p>You don't have to manage the low level communication in most cases. However, it makes sense to know that everything that goes from client to server (and the other way round) is put into "commands". Internally, commands are also used to establish and keep the connection between client and server alive (without carrying additional data).</p>
<p>All functions that are operations (RPC calls) are prefixed with "Op" to tell them apart from anything else. Other server-side applications (like for example MMO or your own) will define different operations. These will have different parameters and return values. These operations are not part of the client library but can be implemented by calling <a class="el" href="a00085.html#a3c1268775eba0cfe2b6f7e309a27e2fd">opCustom()</a>.</p>
<p>Aside from operations, there is a separate communication layer to make UDP reliable. Everything that goes from client to server (and the other way round) is put into "commands" and some commands establish and keep the connection between client and server (without carrying additional data).</p>
<h1><a class="anchor" id="Workflow_Callbacks"></a>
Callbacks</h1>
<p>PhotonPeer uses the virtual functions of the class <a class="el" href="a00084.html">ExitGames::Photon::PhotonListener</a> to do callbacks. Each function is called in separate cases:</p><ul>
<li><a class="el" href="a00084.html#a762c08d3437006f3da1165e296bb52b3">onStatusChanged()</a> is for peer state changes (connect, disconnect, errors)</li>
<li><a class="el" href="a00084.html#a03ff8cb4a6f605668586756cb6a113c7">onOperationResponse()</a> is for operation responses (join, leave, raiseEvent and custom operations, etc.)</li>
<li><a class="el" href="a00084.html#aebac55de19a14f226016bee9dc2125b1">onEvent()</a> gets called for events coming in</li>
<li><a class="el" href="a00052.html#ab4b256b4d717b7d8c142055fbcc9e6c6">debugReturn()</a> is called to pass debug output to you (not used by release builds)</li>
</ul>
<p>The calls to <a class="el" href="a00084.html#a762c08d3437006f3da1165e296bb52b3">onStatusChanged()</a> are of special interest, as they denote connection status changes and errors.</p>
<h1><a class="anchor" id="Workflow_GettersAndSetters"></a>
Getters/Setters</h1>
<p>The following getter- and setter-functions in PhotonPeer are of special interest:</p><ul>
<li><a class="el" href="a00085.html#ab96b54d2894633bf699bdf5b407bb486">setTimePingInterval()</a> sets the time between ping operations</li>
<li><a class="el" href="a00085.html#a3d58f9f28efef342eb2e6b5e90babc95">getRoundTripTime()</a> returns the ping between the Photon client and the server</li>
<li><a class="el" href="a00085.html#a45fdc08e49473ab212a337a2602f01fe">getRoundTripTimeVariance()</a> shows the jitter (variability of the roundtrip time)</li>
<li><a class="el" href="a00085.html#a0d497df1e1e3189833ea9a92a94e4ab8">getServerTime()</a> is the continuously approximated server's time in milliseconds </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Overview</a></li><li class="navelem"><a class="el" href="a00004.html">Photon</a></li>
    <li class="footer">Generated on Thu Apr 30 2015 17:09:20 for Exit Games Photon C++ Client Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
